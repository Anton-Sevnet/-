(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(e){if(e.ep)return;e.ep=!0;const o=s(e);fetch(e.href,o)}})();const O="modulepreload",y=function(n){return"/"+n},_={},L=function(t,s,a){if(!s||s.length===0)return t();const e=document.getElementsByTagName("link");return Promise.all(s.map(o=>{if(o=y(o),o in _)return;_[o]=!0;const r=o.endsWith(".css"),p=r?'[rel="stylesheet"]':"";if(!!a)for(let l=e.length-1;l>=0;l--){const d=e[l];if(d.href===o&&(!r||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${p}`))return;const i=document.createElement("link");if(i.rel=r?"stylesheet":O,r||(i.as="script",i.crossOrigin=""),i.href=o,document.head.appendChild(i),r)return new Promise((l,d)=>{i.addEventListener("load",l),i.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};const c={Button:{CREATE_TASK:"btnCreateTask",CLOSE_POPUP_CREATE_TASK:"btnCloseCreateTaskPopup",POPUP_CREATE_TASK_CONFIRM:"btnConfirmTaskPopup"},Template:{TASK:"templateTask",Task:{TITLE:"templateTaskTitle",BTN_EDIT:"btnEdit",BTN_DELETE:"btnDelete"}},Popup:{CREATE_TASK:"popupContainer",CreateTask:{TITLE:"title"}}},S="tasks",N=["Web","Update","Design","Content"];class m{static fromJSON(t){return new m(t.id,t.title,t.date,t.tag)}constructor(t,s,a,e){this.id=t,this.title=s,this.date=a,this.tag=e}}const C=n=>document.getElementById(n),A=(n,t)=>n.querySelector(`[data-id="${t}"]`),f=C(c.Template.TASK),g=f.parentNode;f.removeAttribute("id");f.remove();const P=localStorage.getItem(S),u=P?JSON.parse(P).map(n=>m.fromJSON(n)):[];u.forEach(n=>h(n));console.log("> tasks:",u);const B={[c.Template.Task.BTN_EDIT]:(n,t)=>{k(n,"Update task","Update",(s,a,e)=>{console.log("> Update task -> On Confirm",{taskTitle:s,taskDate:a,taskTag:e}),n.title=s;const o=h(n);t.parentNode.replaceChild(o,t),E()})},[c.Template.Task.BTN_DELETE]:(n,t)=>{k(n,"Delete task","Delete",(s,a,e)=>{console.log("> Update task -> On Confirm",{taskTitle:s,taskDate:a,taskTag:e});const o=u.indexOf(n);u.splice(o,1),g.removeChild(t),E()})}};g.onclick=n=>{n.stopPropagation();const t=n.target,s=t.dataset.btn;if(!s||![c.Template.Task.BTN_EDIT,c.Template.Task.BTN_DELETE].includes(s))return;let o,r=t;do r=r.parentNode,o=r.dataset.id;while(!o);const p=u.find(i=>i.id===o);console.log(". taskVO: ",p);const T=B[s];T&&T(p,r)};C(c.Button.CREATE_TASK).onclick=()=>{console.log("> domPopupCreateTask.classList"),k(null,"Create task","Create",(n,t,s)=>{console.log("> Main -> Create task -> On Confirm");const a=`task_${Date.now()}`,e=new m(a,n,t,s);h(e),u.push(e),console.log("confirm",e),E()})};function h(n){const t=f.cloneNode(!0);return t.dataset.id=n.id,A(t,c.Template.Task.TITLE).innerText=n.title,g.prepend(t),t}async function k(n,t,s,a){const e=C(c.Popup.CREATE_TASK),o=e.querySelector(".spinner");e.classList.remove("hidden");const r=()=>{e.children[0].remove(),e.append(o),e.classList.add("hidden")},p=(await L(()=>import("./TaskPopup-fc0392fb.js"),[])).default,T=new p(t,N,s,(i,l,d)=>{console.log("Main -> processDataCallback",{taskTitle:i,taskDate:l,taskTags:d}),a(i,l,d),r()},r);n&&(T.taskTitle=n.title),o.remove(),document.onkeyup=i=>{i.key==="Escape"&&r()},e.append(T.render())}function E(){localStorage.setItem(S,JSON.stringify(u))}
